#import "../template.typ":*

= Лекция 7.

== Паросочетание

Мы будем думать о любом паросочетании в графе. $G$ - неор. граф. Есть ребра и вершины. Ребро соединяют 2 вершины, ребра соединяются вершиной.

Найти множество объектов

#definition(title:[ Независимое множество], body:[
  Независимым множеством вершин  графа $G=(V,E)$ называется такое подмножество $S$ множества вершин графа V, что $forall u,v in S: u v  in.not E$
])

Максимальное независимое множество в графе обозначается за $alpha(G)$

#definition(title:[Паросочетание], body:[
  Паросочетание $M$ -- произвольное множество рёбер двудольного графа такое, что никакие два ребра не имеют общей вершины.
])

Максимальный размер паросочетания обозначается $alpha'(G)$



#definition(title:[Контролирующее множество или вершинное покрытие, или реберное покрытие], body:[
  Вершинное - множество вершин, что для любого ребра, хотя бы 1 ребро 

  реберное, для каждой вершины хотя бы 1 ребро находится в этом множестве.
])

$beta(G)$ - размер минимального вершинного покрытия

$beta'(G)$ - размер минимального реберного покрытия


#theorem(name:[Утверждение], body:[
  $alpha(G) + beta(G) = n$
], proof:[Пусть $A$ - независимое множество вершин, возьмем $B = V without A$

Покажем, что тогда $B$ - вершинное покрытие (На самом деле там равносильность)

Из доказанного нами утверждение очевидно следует искомое ведь $|A + A^c| = n$
])

#theorem(title:[Галлаи - 59],body:[
$alpha'(G) + beta'(G) = n$, $delta(G) > 0$], proof:[
  Берем множество непокрытых вершин. Их $n - 2 alpha'(G)$

  $beta'(G)<= alpha'(G) + n - 2 alpha'(G) = n- alpha'(G)$

  Откуда $alpha'(G) + b'(G)<= n$

  $alpha'(G)>= n - beta'(G)$, откуда 
  $alpha'(G) + beta'(G)>=n$

  ->DO: расписать
  
])

#theorem(title:[], body:[
  $G$ - двудольный, то $alpha'(G)=beta(G)$
])

Произвольные графы: $beta(G) >= a'(G)$


#definition(title:[Совершенное паросочетание], body:[
  Граф имееет *совершенное паросочетание*, если $2|M| = |V|$, $2 alpha'(G) =n$
])

#theorem(name:[Теорема Татта], body:[
  $G$ содержит совершенное паросочетание $<=> forall S subset V : |S| >= o d d(G without S)$
  
  где $"odd" (G without S) $— число нечётных по числу вершин компонент связности в графе $ G without S$.
], proof:[
  *В правую сторону*:
  
  Предположим, что в графе  $G$  существует совершенное паросочетание  $M$. Рассмотрим произвольное множество $ U subset V(G)$. 

  Для каждой нечётной компоненты связности $ C$ графа $G without U $ хотя бы одна вершина из $C $ должна быть соединена ребром из $M $ с некоторой вершиной из $U $, так как иначе в $C $ останется непарная вершина. Поскольку паросочетание $M $ совершенное, различные нечётные компоненты должны соединяться с различными вершинами из $U $. Следовательно, число нечётных компонент не превосходит $|U| $.

  *В левую сторону*:

  Предположим, что условие теоремы выполняется, но совершенного паросочетания в $G $ нет. 

Рассмотрим граф $G^* $, полученный из $G $ добавлением рёбер так, чтобы он оставаться графом без совершенного паросочетания, но был бы максимальным в этом смысле (т.е. добавление любого нового ребра приводит к появлению совершенного паросочетания) (или как говорит АС - максимальный контрпимер)

Пусть $U $ — множество вершин $u in V(G^*) $ таких, что все остальные вершины смежны с $u $.


*Утверждение:* Граф $G^* - U $ является объединением несвязных клик (полных графов).

*Доказательство утверждения:*

Предположим, что это не так. Тогда найдутся вершины $x, y, z in.not U $ такие, что $x y, y z in E(G^*) $, но $x z not in E(G^*) $. Так как $y not in U $, существует вершина $w not in U $ такая, что $ y w not in E(G^*)$.

Из максимальности $G^* $ следует:
- В $G^* + x z $ есть совершенное паросочетание $M_1 $, причём $ x z in M_1$.
- В $G^* + y w $ есть совершенное паросочетание $M_2 $, причём $ y w in M_2$.

Рассмотрим граф $H = (V(G), M_1 xor M_2) $.

Граф $ H$ представляет собой объединение чётных циклов, в которых рёбра чередуются из $ M_1$ и $M_2 $.

*Случай 1:* Рёбра $x z $ и $y w $ лежат в разных компонентах связности $H $.

В компоненте с $x z $ выберем рёбра из $M_2 $, в компоненте с $y w $ — из $M_1 $, в остальных — любые. Получим совершенное паросочетание в $G^* $, что противоречит построению.

*Случай 2:* Рёбра $x z $ и $y w $ лежат в одной компоненте связности $H $ (чётном цикле $C $).


Без ограничения общности, расположим вершины в цикле $C $ в порядке $y -> w -> dots -> z -> x -> dots -> y $. Рассмотрим путь $ P = x ->^C z -> y ->^C w $, который проходит через все вершины цикла $ C$, используя ребро $y z in E(G^*)$ и дуги цикла. На этом пути можно выбрать совершенное паросочетание $M_W $, состоящее только из рёбер $G^* $. Комбинируя $ M_W$ с паросочетаниями в других компонентах $H $, снова получим совершенное паросочетание в $ G^*$ — противоречие.

Таким образом, предположение неверно, и $G^* - U $ является объединением клик.

Вернемся к доказательству теоремы

Рассмотрим граф $ G^* - U$. Он состоит из нескольких компонент связности, каждая из которых — клика. В нечётной клике (компоненте с нечётным числом вершин) все рёбра присутствуют, но при удалении $ U$ она становится нечётной компонентой связности.

По условию для графа $G $ (а значит, и для $ G^*$, так как добавление рёбер не нарушает условие), выполняется:
$ "odd"(G^* - U) \leq |U|$

В графе $ G^* - U$ нечётные клики можно полностью паросочетать внутри себя, кроме одной вершины, которая должна быть соединена с вершиной из $ U$. Поскольку в $ G^*$ все вершины из $ U$ соединены со всеми остальными, мы можем построить совершенное паросочетание:
- В каждой нечётной компоненте $ G^* - U$ паросочетаем все вершины, кроме одной, которую соединяем с некоторой вершиной из $ U$.
- В чётных компонентах паросочетаем все вершины внутри компоненты.
- Условие $"odd"(G^* - U) <= |U| $ гарантирует, что на все нечётные компоненты хватит вершин в $ U$.

Таким образом, в $G^* $ существует совершенное паросочетание, что противоречит его построению. Следовательно, исходное предположение неверно, и в графе $ G$ должно существовать совершенное паросочетание. ПОБЕДА


])
  

#definition(title:[Дефицит графа],body:[
  $def G = n - 2 alpha' (G)$
])

#theorem(title:[Формула Бержа], body:[
  $def G = limits(max)_(S subset V) (o d d (G without S) - |S|)$
],proof:[
  Оценка снизу на $def G$ очевидна.

  Идея второй части: 
  Добавим множество вершин $U, |U| =  limits(max)_(S subset V) (o d d (G without S) - |S|)$, из которого будут вести ребра в каждую вершину нашего графа. Покажем, что наш граф тогда по Теорема Татта имеет совершенное паросочетание. Заметим, что тогда удалив из него подграф $U$, мы получим в оставшемся графе как раз не макс. пар соч и $def$ будет равен как раз тому что надо
])